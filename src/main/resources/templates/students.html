<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StudyTracker - Select Student</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .students-container {
            max-width: 600px;
            margin: 50px auto;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }
        .logo {
            text-align: center;
            margin-bottom: 30px;
        }
        .logo h1 {
            color: #007bff;
            font-weight: bold;
        }
        .student-card {
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 15px;
            transition: all 0.3s ease;
            cursor: pointer;
            text-decoration: none;
            color: inherit;
        }
        .student-card:hover {
            border-color: #007bff;
            box-shadow: 0 4px 12px rgba(0,123,255,0.15);
            transform: translateY(-2px);
            text-decoration: none;
            color: inherit;
        }
        .student-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            object-fit: cover;
            margin-right: 15px;
        }
        .student-info {
            flex-grow: 1;
        }
        .student-name {
            font-size: 1.2em;
            font-weight: 600;
            margin-bottom: 5px;
            color: #333;
        }
        .student-id {
            color: #6c757d;
            font-size: 0.9em;
        }
        .no-students {
            text-align: center;
            padding: 40px 20px;
            color: #6c757d;
        }
        .no-students i {
            font-size: 3em;
            margin-bottom: 20px;
            color: #dee2e6;
        }
        .logout-link {
            color: #6c757d;
            text-decoration: none;
            font-size: 0.9em;
        }
        .logout-link:hover {
            color: #007bff;
            text-decoration: underline;
        }
    </style>
</head>
<body class="bg-light">
    <div class="container">
        <div class="students-container bg-white">
            <div class="logo">
                <h1>ðŸ“š StudyTracker</h1>
                <p class="text-muted">Select a student to view their assignments</p>
            </div>

            <!-- Error message display -->
            <div th:if="${error}" class="alert alert-danger alert-dismissible fade show" role="alert">
                <i class="bi bi-exclamation-triangle-fill me-2"></i>
                <span th:text="${error}"></span>
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            </div>

            <!-- Info message display -->
            <div th:if="${message != null and messageType == 'info'}" class="alert alert-info alert-dismissible fade show" role="alert">
                <i class="bi bi-info-circle-fill me-2"></i>
                <span th:text="${message}"></span>
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            </div>

            <!-- Students list -->
            <div th:if="${students != null and !students.empty}">
                <h4 class="mb-3">Your Observed Students</h4>
                <div class="students-list">
                    <a th:each="student : ${students}" 
                       th:href="@{/students/{id}(id=${student.id})}"
                       class="student-card d-flex align-items-center">
                        <img th:if="${student.avatarUrl != null and !student.avatarUrl.empty}" 
                             th:src="${student.avatarUrl}" 
                             th:alt="${student.name + ' avatar'}"
                             class="student-avatar"
                             onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                        <div class="student-avatar d-flex align-items-center justify-content-center bg-secondary text-white"
                             th:style="${student.avatarUrl != null and !student.avatarUrl.empty} ? 'display: none;' : 'display: flex;'"
                             th:text="${#strings.substring(student.name, 0, 1)}">
                        </div>
                        <div class="student-info">
                            <div class="student-name" th:text="${student.name}">Student Name</div>
                            <div class="student-id">
                                <span th:if="${student.shortName != null and !student.shortName.empty}" 
                                      th:text="${student.shortName}"></span>
                                <span th:if="${student.shortName == null or student.shortName.empty}" 
                                      th:text="'ID: ' + ${student.id}"></span>
                            </div>
                        </div>
                        <i class="bi bi-chevron-right text-muted"></i>
                    </a>
                </div>
            </div>

            <!-- No students found -->
            <div th:if="${students == null or students.empty}" class="no-students">
                <div class="mb-3">
                    <i class="bi bi-people"></i>
                </div>
                <h5>No Students Found</h5>
                <p class="mb-4">
                    You don't have any observed students in Canvas, or there was an issue retrieving them.
                </p>
                <div class="alert alert-info">
                    <strong>To observe students in Canvas:</strong><br>
                    1. Ask your student to add you as an observer<br>
                    2. Or contact your Canvas administrator for help<br>
                    3. Make sure you have the correct observer permissions
                </div>
            </div>

            <!-- Footer with logout link -->
            <div class="text-center mt-4 pt-3 border-top">
                <a href="/logout" class="logout-link">
                    <i class="bi bi-box-arrow-right me-1"></i>
                    Logout
                </a>
            </div>
        </div>
    </div>

    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>